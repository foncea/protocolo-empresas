p = trabajando_inf %>%
mutate(Protocolo = factor(Protocolo, levels=nombre[rev(c(2, 1))])) %>%
ggplot(aes(x=tiempo, y=Inf_Trab * 100, color=Protocolo)) +
geom_line() +
ggtitle('Trabajadores Infectados al día por cada 100 Trabajadores - R_0=1.5, R_0(empresa)=1 ') +
ylab('') +
xlab('Dias') +
geom_ribbon(aes(ymin=100*q10, ymax=100*(q90)),alpha=0.3) +
theme_bw()
#facet_wrap(~factor(R0)) +
#scale_y_continuous(labels = scales::percent)
p
ggsave(paste('../plots/resultados_28-04/Infectados en el trabajo 80porciento iter=3000 r0=15 r0emp=1.pdf', sep=''), p)
p = trabajando_inf %>%
mutate(Protocolo = factor(Protocolo, levels=nombre[rev(c(2, 1))])) %>%
ggplot(aes(x=tiempo, y=Inf_Trab * 100, color=Protocolo)) +
geom_line() +
ggtitle('Trabajadores Infectados al día por cada 100 Trabajadores - R_0=1.5, R_0(empresa)=1 ') +
ylab('') +
xlab('Dias') +
geom_ribbon(aes(ymin=100*q25, ymax=100*(q75)),alpha=0.3) +
theme_bw()
#facet_wrap(~factor(R0)) +
#scale_y_continuous(labels = scales::percent)
p
ggsave(paste('../plots/resultados_28-04/Infectados en el trabajo 50porciento iter=3000 r0=15 r0emp=1.pdf', sep=''), p)
p = trabajando_inf %>%
mutate(Protocolo = factor(Protocolo, levels=nombre[rev(c(2, 1))])) %>%
ggplot(aes(x=tiempo, y=Inf_Trab * 100, color=Protocolo)) +
geom_line() +
ggtitle('Trabajadores Infectados al día por cada 100 Trabajadores - R_0=1.5, R_0(empresa)=1 ') +
ylab('') +
xlab('Dias') +
geom_ribbon(aes(ymin=100*q05, ymax=100*(q95)),alpha=0.3) +
theme_bw()
#facet_wrap(~factor(R0)) +
#scale_y_continuous(labels = scales::percent)
p
ggsave(paste('../plots/resultados_28-04/Infectados en el trabajo 90porciento iter=3000 r0=15 r0emp=1.pdf', sep=''), p)
p = trabajando_inf %>%
mutate(Protocolo = factor(Protocolo, levels=nombre[rev(c(2, 1))])) %>%
ggplot(aes(x=tiempo, y=Inf_Trab * 100, color=Protocolo, size=2)) +
geom_line() +
ggtitle('Trabajadores Infectados al día por cada 100 Trabajadores - R_0=1.5, R_0(empresa)=1 ') +
ylab('') +
xlab('Dias') +
geom_ribbon(aes(ymin=100*q05, ymax=100*(q95)),alpha=0.3) +
theme_bw()
#facet_wrap(~factor(R0)) +
#scale_y_continuous(labels = scales::percent)
p
p = trabajando_inf %>%
mutate(Protocolo = factor(Protocolo, levels=nombre[rev(c(2, 1))])) %>%
ggplot(aes(x=tiempo, y=Inf_Trab * 100, color=Protocolo, size=1)) +
geom_line() +
ggtitle('Trabajadores Infectados al día por cada 100 Trabajadores - R_0=1.5, R_0(empresa)=1 ') +
ylab('') +
xlab('Dias') +
geom_ribbon(aes(ymin=100*q05, ymax=100*(q95)),alpha=0.3) +
theme_bw()
#facet_wrap(~factor(R0)) +
#scale_y_continuous(labels = scales::percent)
p
p = trabajando_inf %>%
mutate(Protocolo = factor(Protocolo, levels=nombre[rev(c(2, 1))])) %>%
ggplot(aes(x=tiempo, y=Inf_Trab * 100, color=Protocolo, size=0.5)) +
geom_line() +
ggtitle('Trabajadores Infectados al día por cada 100 Trabajadores - R_0=1.5, R_0(empresa)=1 ') +
ylab('') +
xlab('Dias') +
geom_ribbon(aes(ymin=100*q05, ymax=100*(q95)),alpha=0.3) +
theme_bw()
#facet_wrap(~factor(R0)) +
#scale_y_continuous(labels = scales::percent)
p
p = trabajando_inf %>%
mutate(Protocolo = factor(Protocolo, levels=nombre[rev(c(2, 1))])) %>%
ggplot(aes(x=tiempo, y=Inf_Trab * 100, color=Protocolo)) +
geom_line() +
ggtitle('Trabajadores Infectados al día por cada 100 Trabajadores - R_0=1.5, R_0(empresa)=1 ') +
ylab('') +
xlab('Dias') +
geom_ribbon(aes(ymin=100*q05, ymax=100*(q95)),alpha=0.3) +
theme_bw()
#facet_wrap(~factor(R0)) +
#scale_y_continuous(labels = scales::percent)
p
p = trabajando_inf %>%
mutate(Protocolo = factor(Protocolo, levels=nombre[rev(c(2, 1))])) %>%
ggplot(aes(x=tiempo, y=Inf_Trab * 100, color=Protocolo, size=0.1)) +
geom_line() +
ggtitle('Trabajadores Infectados al día por cada 100 Trabajadores - R_0=1.5, R_0(empresa)=1 ') +
ylab('') +
xlab('Dias') +
geom_ribbon(aes(ymin=100*q05, ymax=100*(q95)),alpha=0.3) +
theme_bw()
#facet_wrap(~factor(R0)) +
#scale_y_continuous(labels = scales::percent)
p
p = trabajando_inf %>%
mutate(Protocolo = factor(Protocolo, levels=nombre[rev(c(2, 1))])) %>%
ggplot(aes(x=tiempo, y=Inf_Trab * 100, color=Protocolo), size=1) +
geom_line() +
ggtitle('Trabajadores Infectados al día por cada 100 Trabajadores - R_0=1.5, R_0(empresa)=1 ') +
ylab('') +
xlab('Dias') +
geom_ribbon(aes(ymin=100*q05, ymax=100*(q95)),alpha=0.3) +
theme_bw()
#facet_wrap(~factor(R0)) +
#scale_y_continuous(labels = scales::percent)
p
p = trabajando_inf %>%
mutate(Protocolo = factor(Protocolo, levels=nombre[rev(c(2, 1))])) %>%
ggplot(aes(x=tiempo, y=Inf_Trab * 100, color=Protocolo), size=2) +
geom_line() +
ggtitle('Trabajadores Infectados al día por cada 100 Trabajadores - R_0=1.5, R_0(empresa)=1 ') +
ylab('') +
xlab('Dias') +
geom_ribbon(aes(ymin=100*q05, ymax=100*(q95)),alpha=0.3) +
theme_bw()
#facet_wrap(~factor(R0)) +
#scale_y_continuous(labels = scales::percent)
p
p = trabajando_inf %>%
mutate(Protocolo = factor(Protocolo, levels=nombre[rev(c(2, 1))])) %>%
ggplot(aes(x=tiempo, y=Inf_Trab * 100, color=Protocolo), size=10) +
geom_line() +
ggtitle('Trabajadores Infectados al día por cada 100 Trabajadores - R_0=1.5, R_0(empresa)=1 ') +
ylab('') +
xlab('Dias') +
geom_ribbon(aes(ymin=100*q05, ymax=100*(q95)),alpha=0.3) +
theme_bw()
#facet_wrap(~factor(R0)) +
#scale_y_continuous(labels = scales::percent)
p
p = trabajando_inf %>%
mutate(Protocolo = factor(Protocolo, levels=nombre[rev(c(2, 1))])) %>%
ggplot(aes(x=tiempo, y=Inf_Trab * 100, color=Protocolo)) +
geom_line(size=10) +
ggtitle('Trabajadores Infectados al día por cada 100 Trabajadores - R_0=1.5, R_0(empresa)=1 ') +
ylab('') +
xlab('Dias') +
geom_ribbon(aes(ymin=100*q05, ymax=100*(q95)),alpha=0.3) +
theme_bw()
#facet_wrap(~factor(R0)) +
#scale_y_continuous(labels = scales::percent)
p
p = trabajando_inf %>%
mutate(Protocolo = factor(Protocolo, levels=nombre[rev(c(2, 1))])) %>%
ggplot(aes(x=tiempo, y=Inf_Trab * 100, color=Protocolo)) +
geom_line(size=2) +
ggtitle('Trabajadores Infectados al día por cada 100 Trabajadores - R_0=1.5, R_0(empresa)=1 ') +
ylab('') +
xlab('Dias') +
geom_ribbon(aes(ymin=100*q05, ymax=100*(q95)),alpha=0.3) +
theme_bw()
#facet_wrap(~factor(R0)) +
#scale_y_continuous(labels = scales::percent)
p
ggsave(paste('../plots/resultados_28-04/Infectados en el trabajo 90porciento iter=3000 r0=15 r0emp=1.pdf', sep=''), p)
p = trabajando_inf %>%
mutate(Protocolo = factor(Protocolo, levels=nombre[rev(c(2, 1))])) %>%
ggplot(aes(x=tiempo, y=Inf_Trab * 100, color=Protocolo)) +
geom_line(size=2) +
ggtitle('Trabajadores Infectados al día por cada 100 Trabajadores - R_0=1.5, R_0(empresa)=1 ') +
ylab('') +
xlab('Dias') +
geom_ribbon(aes(ymin=100*q25, ymax=100*(q75)),alpha=0.3) +
theme_bw()
#facet_wrap(~factor(R0)) +
#scale_y_continuous(labels = scales::percent)
p
ggsave(paste('../plots/resultados_28-04/Infectados en el trabajo 50porciento iter=3000 r0=15 r0emp=1.pdf', sep=''), p)
p = trabajando_inf %>%
mutate(Protocolo = factor(Protocolo, levels=nombre[rev(c(2, 1))])) %>%
ggplot(aes(x=tiempo, y=Inf_Trab * 100, color=Protocolo)) +
geom_line(size=2) +
ggtitle('Trabajadores Infectados al día por cada 100 Trabajadores - R_0=1.5, R_0(empresa)=1 ') +
ylab('') +
xlab('Dias') +
geom_ribbon(aes(ymin=100*q10, ymax=100*(q80)),alpha=0.3) +
theme_bw()
#facet_wrap(~factor(R0)) +
#scale_y_continuous(labels = scales::percent)
p
p = trabajando_inf %>%
mutate(Protocolo = factor(Protocolo, levels=nombre[rev(c(2, 1))])) %>%
ggplot(aes(x=tiempo, y=Inf_Trab * 100, color=Protocolo)) +
geom_line(size=2) +
ggtitle('Trabajadores Infectados al día por cada 100 Trabajadores - R_0=1.5, R_0(empresa)=1 ') +
ylab('') +
xlab('Dias') +
geom_ribbon(aes(ymin=100*q10, ymax=100*(q90)),alpha=0.3) +
theme_bw()
#facet_wrap(~factor(R0)) +
#scale_y_continuous(labels = scales::percent)
p
ggsave(paste('../plots/resultados_28-04/Infectados en el trabajo 50porciento iter=3000 r0=15 r0emp=1.pdf', sep=''), p)
p = trabajando_inf %>%
mutate(Protocolo = factor(Protocolo, levels=nombre[rev(c(2, 1))])) %>%
ggplot(aes(x=tiempo, y=Inf_Trab * 100, color=Protocolo)) +
geom_line(size=2) +
ggtitle('Trabajadores Infectados al día por cada 100 Trabajadores - R_0=1.5, R_0(empresa)=1 ') +
ylab('') +
xlab('Dias') +
geom_ribbon(aes(ymin=100*(Inf_Trab - desv), ymax=100*(Inf_Trab + desv)),alpha=0.3) +
theme_bw()
#facet_wrap(~factor(R0)) +
#scale_y_continuous(labels = scales::percent)
p
ggsave(paste('../plots/resultados_28-04/Infectados en el trabajo una desv iter=3000 r0=15 r0emp=1.pdf', sep=''), p)
p = trabajando_inf %>%
mutate(Protocolo = factor(Protocolo, levels=nombre[rev(c(2, 1))])) %>%
ggplot(aes(x=tiempo, y=Inf_Trab * 100, color=Protocolo)) +
geom_line(size=2) +
ggtitle('Trabajadores Infectados al día por cada 100 Trabajadores - R_0=1.5, R_0(empresa)=1 ') +
ylab('') +
xlab('Dias') +
geom_ribbon(aes(ymin=100*(Inf_Trab - desv / 2), ymax=100*(Inf_Trab + desv / 2)),alpha=0.3) +
theme_bw()
#facet_wrap(~factor(R0)) +
#scale_y_continuous(labels = scales::percent)
p
ggsave(paste('../plots/resultados_28-04/Infectados en el trabajo media desv iter=3000 r0=15 r0emp=1.pdf', sep=''), p)
p = trabajando_inf %>%
mutate(Protocolo = factor(Protocolo, levels=nombre[rev(c(2, 1))])) %>%
ggplot(aes(x=tiempo, y=Inf_Trab * 100, color=Protocolo)) +
geom_line(size=2) +
ggtitle('Trabajadores Infectados al día por cada 100 Trabajadores - R_0=1.5, R_0(empresa)=1 ') +
ylab('') +
xlab('Dias') +
geom_ribbon(aes(ymin=100*(Inf_Trab - desv), ymax=100*(Inf_Trab + desv),alpha=0.3) +
theme_bw()
#facet_wrap(~factor(R0)) +
#scale_y_continuous(labels = scales::percent)
p
}
ggsave(paste('../plots/resultados_28-04/Infectados en el trabajo media desv iter=3000 r0=15 r0emp=1.pdf', sep=''), p)
################################################################################
# Numero de PCR
{
n=7
sim = paste('_' , alg[n] , '_frec=' , frec_test[n] , '_pob=' , pob[n] , '_cinic=', ctna_inic[n], '_r0=' , r0[n] , '_pi=', p_inic[n], '_iter=' , iteraciones[n], '_' , fecha[n] , sep='')
resultados = read.csv(paste('datos_simulaciones/numero_pcr', sim, '.csv', sep='')) %>%
mutate(Protocolo = nombre[n], PCR = pcr[n])
for(n in 8:length(alg)){
sim = paste('_' , alg[n] , '_frec=' , frec_test[n] , '_pob=' , pob[n] , '_cinic=', ctna_inic[n], '_r0=' , r0[n] , '_pi=', p_inic[n], '_iter=' , iteraciones[n], '_' , fecha[n] , sep='')
aux = read.csv(paste('datos_simulaciones/numero_pcr', sim, '.csv', sep='')) %>%
mutate(Protocolo = nombre[n], PCR = pcr[n])
resultados = rbind(resultados, aux)
}
p = resultados %>%
mutate(Protocolo = factor(Protocolo, levels=nombre[c(3,2,1)])) %>%
group_by(Protocolo) %>%
summarize(X0 = last(X0) / 1000) %>%
ggplot(aes(x=factor(Protocolo), y=X0)) +
geom_bar(stat='identity', position='dodge', color='black') +
ggtitle('Número Test PCR - R0(emp) = 1') +
ylab('') +
xlab('') +
scale_fill_brewer(palette='Set3') +
#scale_fill_viridis(option='viridis', discrete=TRUE) +
geom_text(aes(label=round(X0, 0)), position=position_dodge(width=0.9), vjust=-0.25) +
theme_bw()
p
}
ggsave(paste('plots/senama_24-04/Numero Test PCR.pdf', sep=''), p)
################################################################################
# Numero de Dias infecciosos en el trabajo
{
n=1
sim = paste('_' , alg[n] , '_frec=' , frec_test[n] , '_pob=' , pob[n] , '_cinic=', ctna_inic[n], '_r0=' , r0[n] , '_pi=', p_inic[n], '_iter=' , iteraciones[n], '_' , fecha[n] , sep='')
resultados = read.csv(paste('datos_simulaciones/resultados', sim, '.csv', sep=''))
resultados$X = NULL
dias_infecciosos = resultados %>%
filter(estado == 'infeccioso' & actividad == 'trabajo') %>%
complete(tiempo=0:156, it=0:999, fill=list(X0=0)) %>%
group_by(it) %>%
summarize(Dias_Inf = sum(X0)) %>%
mutate(Protocolo = nombre[n],
Inf_Inic = percent(p_inic[n]))
for(n in 2:length(alg)){
sim = paste('_' , alg[n] , '_frec=' , frec_test[n] , '_pob=' , pob[n] , '_cinic=', ctna_inic[n], '_r0=' , r0[n] , '_pi=', p_inic[n], '_iter=' , iteraciones[n], '_' , fecha[n] , sep='')
resultados = read.csv(paste('datos_simulaciones/resultados', sim, '.csv', sep=''))
resultados$X = NULL
aux =  resultados %>%
filter(estado == 'infeccioso' & actividad == 'trabajo') %>%
complete(tiempo=0:156, it=0:999, fill=list(X0=0)) %>%
group_by(it) %>%
summarize(Dias_Inf = sum(X0)) %>%
mutate(Protocolo = nombre[n],
Inf_Inic = percent(p_inic[n]))
dias_infecciosos = rbind(dias_infecciosos, aux)
}
p = dias_infecciosos %>%
mutate(Protocolo = factor(Protocolo, levels=nombre[c(3,2,1)])) %>%
ggplot(aes(x=factor(Inf_Inic), y=Dias_Inf, fill=Protocolo)) +
geom_boxplot(outlier.shape=NA) +
ggtitle('Dias-Hombre Infectados en el Trabajo') +
ylab('') +
xlab('Porcentaje Inicial de la Población Infectada') +
theme_bw() +
scale_fill_brewer(palette='Set3') +
coord_cartesian(ylim = c(0, 50))
ylim1 = boxplot.stats(df$y)$stats[c(1, 5)]
# scale y limits based on ylim1
p1 = p0 + coord_cartesian(ylim = ylim1*1.05)
p
}
#ggsave(paste('plots/senama_senama_23-04/Dias-hombre Infectados en Trabajo - Boxplot.pdf', sep=''), p)
################################################################################
# Poblacion infectada trabajando
{
n=1
sim = paste('_' , alg[n] , '_frec=' , frec_test[n] , '_pob=' , pob[n] , '_cinic=', ctna_inic[n], '_r0=' , r0[n] , '_pi=', p_inic[n], '_iter=' , iteraciones[n], '_' , fecha[n] , sep='')
resultados = read.csv(paste('datos_simulaciones/resultados', sim, '.csv', sep=''))
resultados$X = NULL
trabajando_inf = resultados %>%
filter(actividad == 'trabajo') %>%
group_by(it, tiempo) %>%
mutate(trabajando = sum(X0)) %>%
filter(estado == 'infeccioso') %>%
group_by(tiempo) %>%
summarize(Inf_Trab = sum(X0 / trabajando) / iteraciones[n], trabajando = first(trabajando)) %>%
mutate(Protocolo = nombre[n], PCR = pcr[n], R0 = r0[n])
for(n in 2:length(alg)){
sim = paste('_' , alg[n] , '_frec=' , frec_test[n] , '_pob=' , pob[n] , '_cinic=', ctna_inic[n], '_r0=' , r0[n] , '_pi=', p_inic[n], '_iter=' , iteraciones[n], '_' , fecha[n] , sep='')
resultados = read.csv(paste('datos_simulaciones/resultados', sim, '.csv', sep=''))
resultados$X = NULL
aux =  resultados %>%
filter(actividad == 'trabajo') %>%
group_by(it, tiempo) %>%
mutate(trabajando = sum(X0)) %>%
filter(estado == 'infeccioso') %>%
group_by(tiempo) %>%
summarize(Inf_Trab = sum(X0 / trabajando) / iteraciones[n], trabajando = first(trabajando)) %>%
mutate(Protocolo = nombre[n], PCR = pcr[n], R0 = r0[n])
trabajando_inf = rbind(trabajando_inf, aux)
}
p = trabajando_inf %>%
mutate(Protocolo = factor(Protocolo, levels=nombre[rev(c(2, 1))])) %>%
ggplot(aes(x=tiempo, y=Inf_Trab, color=Protocolo)) +
geom_line() +
ggtitle('Porcentaje de Trabajadores Infectados') +
ylab('') +
xlab('Dias') +
facet_wrap(~factor(R0)) +
scale_y_continuous(labels = scales::percent)
p
tabla = trabajando_inf %>%
mutate(Protocolo = factor(Protocolo, levels=nombre[rev(c(3,2, 1))])) %>%
group_by(Protocolo, R0) %>%
summarize(Trabajando = percent(mean(trabajando) / 100), Infectados = percent(mean(Inf_Trab)))
tabla = tabla[order(tabla$R0), ]
}
################################################################################
# Poblacion infectada total
{
n=1
sim = paste('_' , alg[n] , '_frec=' , frec_test[n] , '_pob=' , pob[n] , '_cinic=', ctna_inic[n], '_r0=' , r0[n] , '_pi=', p_inic[n], '_iter=' , iteraciones[n], '_' , fecha[n] , sep='')
resultados = read.csv(paste('datos_simulaciones/resultados', sim, '.csv', sep=''))
resultados$X = NULL
trabajando_inf = resultados %>%
group_by(it, tiempo) %>%
mutate(trabajando = sum(X0)) %>%
filter(estado == 'infeccioso') %>%
group_by(tiempo) %>%
summarize(Inf_Trab = sum(X0 / trabajando) / iteraciones[n]) %>%
mutate(Protocolo = nombre[n], PCR = pcr[n], R0 = r0[n])
for(n in 2:length(alg)){
sim = paste('_' , alg[n] , '_frec=' , frec_test[n] , '_pob=' , pob[n] , '_cinic=', ctna_inic[n], '_r0=' , r0[n] , '_pi=', p_inic[n], '_iter=' , iteraciones[n], '_' , fecha[n] , sep='')
resultados = read.csv(paste('datos_simulaciones/resultados', sim, '.csv', sep=''))
resultados$X = NULL
aux =  resultados %>%
group_by(it, tiempo) %>%
mutate(trabajando = sum(X0)) %>%
filter(estado == 'infeccioso') %>%
group_by(tiempo) %>%
summarize(Inf_Trab = sum(X0 / trabajando) / iteraciones[n]) %>%
mutate(Protocolo = nombre[n], PCR = pcr[n], R0 = r0[n])
trabajando_inf = rbind(trabajando_inf, aux)
}
p = trabajando_inf %>%
mutate(Protocolo = factor(Protocolo, levels=nombre[rev(c(2,3, 1))])) %>%
ggplot(aes(x=tiempo, y=Inf_Trab * 100, color=Protocolo)) +
geom_line() +
ggtitle('Infectados Total al día por cada 100 Trabajadores ') +
ylab('') +
xlab('Dias') +
theme_bw()
#facet_wrap(~factor(R0)) +
#scale_y_continuous(labels = scales::percent)
p
}
ggsave(paste('../plots/resultados_28-04/Infectados totales (no porcentajes) iter=200.pdf', sep=''), p)
infecciones_2 %>%
ggplot(aes(x=tiempo, y=1 - (total_inf/1000), color=Protocolo)) +
geom_line() +
facet_wrap(~factor(Inf_Inic))
infecciones_2 %>%
ggplot(aes(x=tiempo, y=1 - total_inf/1000, fill=Protocolo)) +
geom_bar(stat='identity', position='dodge') +
facet_wrap(~factor(Inf_Inic))
resultados = read.csv(paste('datos_simulaciones/resultados', sim, '.csv', sep=''))
resultados$X = NULL
resultados$actividad = as.character(resultados$actividad)
resultados$actividad[resultados$actividad == 'trabajo'] = 'activo'
resultados$actividad = as.factor(resultados$actividad)
estado = resultados[c('estado', 'X0', 'tiempo', 'it')] %>%
sumario_tabla(c('Estado'))
estado$alg = nombre[n]
estado$ctna_inic = ctna_inic[n] > 0
estado$p_inic = p_inic[n]
actividad = resultados[c('actividad', 'X0', 'tiempo', 'it')] %>%
sumario_tabla(c('Actividad'))
actividad$alg = nombre[n]
actividad$ctna_inic = ctna_inic[n] > 0
actividad$p_inic = p_inic[n]
for(n in 2:length(alg)){
sim = paste('_' , alg[n] , '_frec=' , frec_test[n] , '_pob=' , pob[n] , '_cinic=', ctna_inic[n], '_r0=' , r0[n] , '_pi=', p_inic[n], '_iter=' , iteraciones[n], '_' , fecha[n] , sep='')
resultados = read.csv(paste('datos_simulaciones/resultados', sim, '.csv', sep=''))
resultados$X = NULL
resultados$actividad = as.character(resultados$actividad)
resultados$actividad[resultados$actividad == 'trabajo'] = 'activo'
resultados$actividad = as.factor(resultados$actividad)
aux = resultados[c('estado', 'X0', 'tiempo', 'it')] %>%
sumario_tabla(c('Estado'))
aux$alg = nombre[n]
aux$ctna_inic = ctna_inic[n] > 0
aux$p_inic = p_inic[n]
estado = rbind(estado, aux)
aux = resultados[c('actividad', 'X0', 'tiempo', 'it')] %>%
sumario_tabla(c('Actividad'))
aux$alg = nombre[n]
aux$ctna_inic = ctna_inic[n] > 0
aux$p_inic = p_inic[n]
actividad = rbind(actividad, aux)
#estado_actividad = resultados[c('estado', 'actividad', 'X0', 'tiempo', 'it')]
}
estado_inf = estado %>%
filter(Estado == 'infeccioso' & Dias %% 26 == 0) %>%
group_by(alg, ctna_inic, p_inic) %>%
summarise(Total_Infecciosos = percent(sum(Poblacion) / pob[1])) %>%
rename(Protocolo = alg, Cuarentena_Inicial = ctna_inic)
estado_inf2 = estado %>%
filter(Estado == 'infeccioso') %>%
group_by(alg, ctna_inic, p_inic) %>%
summarise(Total_Infecciosos = sum(Poblacion) / 26)
actividad_act = actividad %>%
filter(Actividad == 'activo') %>%
group_by(alg, ctna_inic, p_inic) %>%
summarise(Promedio_Trabajando = percent(mean(Poblacion) / pob[1])) %>%
rename(Protocolo = alg, Cuarentena_Inicial = ctna_inic)
estado_sum = data.frame(t(spread(estado_inf, key=p_inic, value=Total_Infecciosos)))
actividad_sum = data.frame(t(spread(actividad_act, key=p_inic, value=Promedio_Trabajando)))
formattable(estado_sum)
formattable(actividad_sum)
p = trabajando_inf %>%
mutate(Protocolo = factor(Protocolo, levels=nombre[rev(c(2, 1))])) %>%
ggplot(aes(x=tiempo, y=Inf_Trab * 100, color=Protocolo)) +
geom_line(size=2) +
ggtitle('Trabajadores Infectados al día por cada 100 Trabajadores - R_0=1.5, R_0(empresa)=1 ') +
ylab('') +
xlab('Dias') +
geom_ribbon(aes(ymin=100*(Inf_Trab - desv/4), ymax=100*(Inf_Trab + desv.4)),alpha=0.3) +
theme_bw()
#facet_wrap(~factor(R0)) +
#scale_y_continuous(labels = scales::percent)
p
p = trabajando_inf %>%
mutate(Protocolo = factor(Protocolo, levels=nombre[rev(c(2, 1))])) %>%
ggplot(aes(x=tiempo, y=Inf_Trab * 100, color=Protocolo)) +
geom_line(size=2) +
ggtitle('Trabajadores Infectados al día por cada 100 Trabajadores - R_0=1.5, R_0(empresa)=1 ') +
ylab('') +
xlab('Dias') +
geom_ribbon(aes(ymin=100*(Inf_Trab - desv/4), ymax=100*(Inf_Trab + desv/4)),alpha=0.3) +
theme_bw()
#facet_wrap(~factor(R0)) +
#scale_y_continuous(labels = scales::percent)
p
ggsave(paste('../plots/resultados_28-04/Infectados en el trabajo cuarto desv iter=3000 r0=15 r0emp=1.pdf', sep=''), p)
p = trabajando_inf %>%
mutate(Protocolo = factor(Protocolo, levels=nombre[rev(c(2, 1))])) %>%
ggplot(aes(x=tiempo, y=Inf_Trab * 100, color=Protocolo)) +
geom_line(size=2) +
ggtitle('Trabajadores Infectados al día por cada 100 Trabajadores - R_0=1.5, R_0(empresa)=1 ') +
ylab('') +
xlab('Dias') +
geom_ribbon(aes(ymin=100*(q10), ymax=100*(q90)),alpha=0.3) +
theme_bw()
#facet_wrap(~factor(R0)) +
#scale_y_continuous(labels = scales::percent)
p
ggsave(paste('../plots/resultados_28-04/Infectados en el trabajo 80porciento desv iter=3000 r0=15 r0emp=1.pdf', sep=''), p)
p = trabajando_inf %>%
mutate(Protocolo = factor(Protocolo, levels=nombre[rev(c(2, 1))])) %>%
ggplot(aes(x=tiempo, y=Inf_Trab * 100, color=Protocolo)) +
geom_line(size=2) +
ggtitle('Trabajadores Infectados al día por cada 100 Trabajadores - R_0=1.5, R_0(empresa)=1 ') +
ylab('') +
xlab('Dias') +
geom_ribbon(aes(ymin=100*(q25), ymax=100*(q75)),alpha=0.3) +
theme_bw()
#facet_wrap(~factor(R0)) +
#scale_y_continuous(labels = scales::percent)
p
ggsave(paste('../plots/resultados_28-04/Infectados en el trabajo 50porciento desv iter=3000 r0=15 r0emp=1.pdf', sep=''), p)
install_github("vqv/ggbiplot")
library(devtools)
install_github("vqv/ggbiplot")
library(ggbiplot)
